tab1[nrow(tab1) + 1,] = x
x = c(rowSums(tab1))[1:1]
x
x = c(rowSums(tab1))[1:1]
x
colSums(tab1);
tab1[nrow(tab1) + 1,] = x
x[0]
x = rowSums(tab1)[1:1]
x = rowSums(tab1)[1:1]
x[0]
x
x[0,0]
x[0]
x = rowSums(tab1)
colSums(tab1);
tab1[nrow(tab1) + 1,] = x
rbind(tab1,x)
total = rowSums(tab1)
colSums(tab1);
rbind(tab1,x)
tab1;
total = rowSums(tab1)
colSums(tab1);
rbind(tab1,total)
tab1;
total1 = rowSums(tab1)
colSums(tab1);
rbind(tab1,total)
cbind(tab1,total1)
tab
tab1 = table(data_titanic$Survived,data_titanic$Sex);
tab1;
total1 = rowSums(tab1)
colSums(tab1);
tab = rbind(tab1,total)
tab = cbind(tab,total1)
tab
tab1 = table(data_titanic$Survived,data_titanic$Sex);
tab1;
total= rowSums(tab1)
total1 = colSums(tab1);
tab = rbind(tab1,total)
tab = cbind(tab,total1)
tab = cbind(tab,total1)
tab
titanic <- read.table(file="datatitanic.txt", header=TRUE)
titanic <- read.table(file="data/titanic.txt", header=TRUE)
tab1 = table(data_titanic$Survived,data_titanic$Sex);
tab1;
total= rowSums(tab1)
total1 = colSums(tab1);
tab = rbind(tab1,total)
tab = cbind(tab,total1)
tab
tab1 = table(data_titanic$Survived,data_titanic$Sex);
tab1;
total1= rowSums(tab1)
total = colSums(tab1);
tab = rbind(tab1,total)
tab = cbind(tab,total1)
tab
total1= rowSums(tab1)
total = colSums(tab1,0);
tab = rbind(tab1,total)
tab = cbind(tab,total1)
tab
tab1 = table(data_titanic$Survived,data_titanic$Sex);
tab1;
total1= rowSums(tab1)
total = colSums(tab1);
tab = rbind(tab1,total)
tab = cbind(tab,total1)
tab
chisq.test(tab1)
tab
total1= rowSums(rbind(tab1,0))
total = colSums(tab1);
tab = rbind(tab1,total)
tab = cbind(tab,total1)
tab
total1= rowSums(rbind(tab1,-))
total1= rowSums(rbind(tab1,"-"))
total = colSums(tab1);
tab = rbind(tab1,total)
tab = cbind(tab,total1)
tab
total1= rowSums(rbind(tab1,"-"))
total = colSums(tab1);
total1= rowSums(rbind(tab1,NaN))
total = colSums(tab1);
tab = rbind(tab1,total)
tab = cbind(tab,total1)
tab
tab1 = table(data_titanic$Survived,data_titanic$Sex);total_s= rowSums(rbind(tab1,NaN))
total_g = colSums(tab1);
tab = rbind(tab1,total)
tab = cbind(tab,total1)
tab
tab1 = table(data_titanic$Survived,data_titanic$Sex);total_s= rowSums(rbind(tab1,NaN))
total_g = colSums(tab1);
tab = rbind(tab1,total_g)
tab = cbind(tab,total_s)
tab
tab
chisq.test(tab1)
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab = rbind(tab1,total_g);tab = cbind(tab,total_s)
tab
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab = cbind(tab,total_s)
tab1
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab = cbind(tab,total_s)
tab1
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab = cbind(tab,total_s)
tab1
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab = cbind(tab,total_s)
tab1
tab1 = rbind(tab1,total_g);tab1 = cbind(tab,total_s)
tab1
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab1 = cbind(tab,total_s)
tab1
titanic <- read.table(file="data/titanic.txt", header=TRUE)
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab1 = cbind(tab,total_s)
tab1
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
tab1
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab2);
tab1 = rbind(tab2,total_g);tab = cbind(tab,total_s)
tab1
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_s= rowSums(rbind(tab2,NaN));total_g = colSums(tab2);
tab2 = rbind(tab2,total_g);tab = cbind(tab2,total_s)
tab2
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_s= rowSums(rbind(tab2,NaN));total_g = colSums(tab2);
tab2 = rbind(tab2,total_g);tab2 = cbind(tab2,total_s)
tab2
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_s= rowSums(rbind(tab2,NaN));total_g = colSums(tab2);
tab2 = rbind(tab2,total_c);tab2 = cbind(tab2,total_s)
tab2
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
tab1
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_c= rowSums(rbind(tab2,NaN));total_g = colSums(tab2);
tab2 = rbind(tab2,total_c);tab2 = cbind(tab2,total_s)
tab2
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_c= rowSums(rbind(tab2,NaN));total_g = colSums(tab2);
tab2 = rbind(tab2,total_c);tab2 = cbind(tab2,total_s)
tab2
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_c= rowSums(rbind(tab2,NaN))
total_g = colSums(tab2);
total_g
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_c= rowSums(rbind(tab2,NaN))
total_g = colSums(tab2);
total_g
tab2 = rbind(tab2,total_g);tab2 = cbind(tab2,total_s)
tab2
total_c= rowSums(rbind(tab2,NaN))total_g = colSums(tab2);
tab2 = rbind(tab2,total_g);tab2 = cbind(tab2,total_s)
tab2
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_c= rowSums(rbind(tab2,NaN))total_g = colSums(tab2);
tab2 = rbind(tab2,total_g);tab2 = cbind(tab2,total_s)
tab2
```{r, fig.width = 12, fig.height=6}
data_flies <- read.table(file="data/fruitflies.txt", header=TRUE)
data_flies$activity <- as.factor(data_flies$activity)
# add loglongevity
data_flies <- data_flies %>% mutate(loglongevity = log(longevity))
plot(data_flies$loglongevity~data_flies$activity)
plot(loglongevity~thorax,pch=as.character(activity), data=data_flies)
data_flies <- read.table(file="data/fruitflies.txt", header=TRUE)
data_flies$activity <- as.factor(data_flies$activity)
# add loglongevity
data_flies <- data_flies %>% mutate(loglongevity = log(longevity))
# make informative plot - boxplot
par(mfrow=c(1,2));
plot(data_flies$loglongevity~data_flies$activity)
plot(loglongevity~thorax,pch=as.character(activity), data=data_flies)
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
tab1
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
tab1
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
par(mfrow=c(1,3))
titanic <- read.table(file="data/titanic.txt", header=TRUE)
titanic$Survived = as.factor(titanic$Survived)
plot1 <- qplot(x = Age, fill = Survived, data = titanic, show.legend = FALSE)
plot2 <- qplot(x = PClass, fill = Survived, data = titanic, show.legend = FALSE)
plot3 <- qplot(x = Sex,fill=Survived, data = titanic)
grid.arrange(plot1, plot2, plot3, ncol=3)
grid.arrange(plot1, plot2, plot3, ncol=3)
titanic <- read.table(file="data/titanic.txt", header=TRUE)
class_sex =  xtabs(~PClass+ Sex, data=titanic);class_sex
class_sex =  xtabs(~PClass+ Sex, data=titanic);class_sex
tot = xtabs(Survived ~ PClass + Sex, data=titanic);tot
round(tot/class_sex, 2)
# what to do with NAs?
titanic$PClass <- as.factor(titanic$PClass)
titanic$Sex <- as.factor(titanic$Sex)
logistic <- glm(Survived~PClass+Age+Sex, data = titanic, family = binomial)
summary(logistic)$coefficients
odds_male_example =  exp(3.7597 + 1 * -1.2920 + 0 * -2.5214 + 1 * -2.6314 + 25 * -0.0392)
odds_male_example
odds_female_example =  exp(3.7597 + 0 * -1.2920 + 0 * -2.5214 + 0 * -2.6314 + 25 * -0.0392)
odds_female_example
# interaction of sex and age
logistic_interaction_sex <- glm(Survived~Age*Sex, data = titanic, family = binomial)
summary(logistic_interaction_sex)$coefficients
summary(logistic_interaction_pclass)$coefficients
# add the interaction term
logistic_interaction_1 <- glm(Survived~PClass+Age+Sex+Age:Sex, data = titanic, family = binomial) # remove Age
logistic_interaction_2 <- glm(Survived~PClass+Sex+Age:Sex, data = titanic, family = binomial) # remove Sex
logistic_interaction_final <- glm(Survived~PClass+Age:Sex, data = titanic, family = binomial)
summary(logistic_interaction_final)$coefficients
# predict for 53 years and all PClass, Sex
classes <- as.character(unique(titanic$PClass))
sexes <- as.character(unique(titanic$Sex))
age <- 53
new_data <- expand.grid(PClass = classes, Sex = sexes, Age = age)
results <- predict(logistic_interaction_final, new_data, type="response")
final <- new_data %>% bind_cols(Survival = results)
knitr::kable(final)
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
tab1
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_c= rowSums(rbind(tab2,NaN))total_g = colSums(tab2);
total_c= rowSums(rbind(tab2,NaN));total_g = colSums(tab2);
tab2 = rbind(tab2,total_g);tab2 = cbind(tab2,total_s)
tab2
# Makes a contingency table and chi-squared test for survived with class and gender
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
knitr::kable(tab1)
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_c= rowSums(rbind(tab2,NaN));total_g = colSums(tab2);
tab2 = rbind(tab2,total_g);tab2 = cbind(tab2,total_s)
knitr::kable(tab2)
titanic <- read.table(file="data/titanic.txt", header=TRUE)
titanic$Survived = as.factor(titanic$Survived)
plot1 <- qplot(x = Age, fill = Survived, data = titanic, show.legend = FALSE)
plot2 <- qplot(x = PClass, fill = Survived, data = titanic, show.legend = FALSE)
plot3 <- qplot(x = Sex,fill=Survived, data = titanic)
grid.arrange(plot1, plot2, plot3, ncol=3)
grid.arrange(plot1, plot2, plot3, ncol=3)
titanic <- read.table(file="data/titanic.txt", header=TRUE)
class_sex =  xtabs(~PClass+ Sex, data=titanic);knitr::kable(class_sex)
class_sex =  xtabs(~PClass+ Sex, data=titanic);knitr::kable(class_sex)
tot = xtabs(Survived ~ PClass + Sex, data=titanic);knitr::kable(tot)
titanic <- read.table(file="data/titanic.txt", header=TRUE)
class_sex =  xtabs(~PClass+ Sex, data=titanic);knitr::kable(class_sex)
tot = xtabs(Survived ~ PClass + Sex, data=titanic);knitr::kable(tot)
knitr::kable(round(tot/class_sex, 2))
grid.arrange(plot1, plot2, plot3, ncol=3)
grid.arrange(plot1, plot2, plot3, ncol=3)
titanic <- read.table(file="data/titanic.txt", header=TRUE)
titanic <- read.table(file="data/titanic.txt", header=TRUE)
class_sex =  xtabs(~PClass+ Sex, data=titanic);knitr::kable(class_sex)
tot = xtabs(Survived ~ PClass + Sex, data=titanic);knitr::kable(tot)
tot = xtabs(Survived ~ PClass + Sex, data=titanic);knitr::kable(tot)
knitr::kable(round(tot/class_sex, 2))
```{r}
# Makes a contingency table and chi-squared test for survived with class and gender
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
knitr::kable(tab1)
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
tab2 = rbind(tab2,total_g);tab2 = cbind(tab2,total_s)
knitr::kable(tab2)
tab1 = table(data_titanic$Survived,data_titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
knitr::kable(tab1)
tab2 = table(data_titanic$Survived,data_titanic$PClass)
chisq.test(tab2)
total_c= rowSums(rbind(tab2,NaN));total_g = colSums(tab2);
tab2 = rbind(tab2,total_g);tab2 = cbind(tab2,total_s)
knitr::kable(tab2)
tab1 = table(titanic$Survived,titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
knitr::kable(tab1)
tab2 = table(titanic$Survived,titanic$PClass)
chisq.test(tab2)
total_c= rowSums(rbind(tab2,NaN));total_g = colSums(tab2);
tab2 = rbind(tab2,total_g);tab2 = cbind(tab2,total_s)
knitr::kable(tab2)
# Makes a contingency table and chi-squared test for survived with class and gender
tab1 = table(titanic$Survived,titanic$Sex)
chisq.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
knitr::kable(tab1)
knitr::kable(tab1)
tab2 = table(titanic$Survived,titanic$PClass)
total_c= rowSums(rbind(tab2,NaN));total_g = colSums(tab2);
tab2 = rbind(tab2,total_g);tab2 = cbind(tab2,total_s)
knitr::kable(tab2)
total_c= rowSums(tab2);total_g = colSums(tab2);
tab2 = rbind(tab2,total_g);tab2 = cbind(tab2,total_s)
knitr::kable(tab2)
plot(loglongevity~thorax,pch=as.character(activity), data=data_flies)
# plot(data_flies$loglongevity~data_flies$activity)
plot(loglongevity~thorax,pch=as.character(activity), data=data_flies)
library(tidyverse)
library(rstudioapi)
library(lme4)
library(car)
library(gridExtra)
knitr::opts_chunk$set(echo = TRUE)
setwd(dirname(getActiveDocumentContext()$path))
# round numbers to 3 digits
options(digits = 3)
fisher.test(tab1)
# Makes a contingency table and chi-squared test for survived with class and gender
tab1 = table(titanic$Survived,titanic$Sex)
fisher.test(tab1)
```{r, fig.width = 12, fig.height=6}
data_flies <- read.table(file="data/fruitflies.txt", header=TRUE)
data_flies$activity <- as.factor(data_flies$activity)
# make informative plot - boxplot
par(mfrow=c(1,2));
# plot(data_flies$loglongevity~data_flies$activity)
plot(loglongevity~thorax,pch=as.character(activity), data=data_flies)
data_flies <- read.table(file="data/fruitflies.txt", header=TRUE)
data_flies$activity <- as.factor(data_flies$activity)
# add loglongevity
data_flies <- data_flies %>% mutate(loglongevity = log(longevity))
**a)** Make an informative plot of the data. Investigate whether sexual activity influences longevity by performing a statistical test, without taking the thorax length into account. What are the estimated longevities for the three conditions? Comment.
```{r, fig.width = 12, fig.height=6}
data_flies <- read.table(file="data/fruitflies.txt", header=TRUE)
data_flies$activity <- as.factor(data_flies$activity)
# add loglongevity
data_flies <- data_flies %>% mutate(loglongevity = log(longevity))
# make informative plot - boxplot
par(mfrow=c(1,2));
# plot(data_flies$loglongevity~data_flies$activity)
plot(loglongevity~thorax,pch=as.character(activity), data=data_flies)
```
From the boxplot we can see that there could be a significant difference in the means of loglongevity for high sexual activity level. In the scatter plot on the right there seems to be a positive relationship between thorax and loglongevity, however any clear influence of the sexual activity level can not be observed.
```{r, fig.width = 12, fig.height=6}
# perform test to see if sexual activity has an effect on longevity
model <- lm(loglongevity~activity, data = data_flies) # prepare model
par(mfrow=c(1,2)); plot(model, 1); plot(model, 2) # investigate normality
anova(model); summary(model)$coefficients
```
One-way ANOVA was performed to investigate whether sexual activity has an effect on loglongevity. From the results we can see that the p-values < 0.05 meaning that sexual activity level significantly influences loglongevity. From the summary table we can see that all estimates are significantly different from 0: for high sexual activity the estimate is 3.602, for isolated it is 3.602 + 0.517 = 4.119 and for low it is 3.602 + 0.398 = 4.
# make informative plot - boxplot
Test diagnostics: no relationship can be observed in the residuals vs fitted plot. QQ-plot seems to follow a straigt line, however there are some outliers at the extremes.
**b)** Investigate whether sexual activity influences longevity by performing a statistical test, now including thorax length as an explanatory variable into the analysis. Does sexual activity increase or decrease longevity? What are the estimated longevities for the three groups, for a fly with average thorax length?
# calculate mean thorax
mean_thorax <- mean(data_flies$thorax)
# calculate estimates
estimate_high <- exp(1)**(intercept + alpha_high + beta * mean_thorax)
estimate_isolated <- exp(1)**(intercept + alpha_isolated + beta * mean_thorax)
estimates <- c(estimate_isolated, estimate_low, estimate_high)
activity_levels <- unique(as.character(data_flies$activity))
knitr::kable(data.frame(Activity = activity_levels,
`Longevity estimate` = estimates),
caption = "Longevity estimates for average thorax fruit fly")
# perform additive ANCOVA analysis
model_1 <- lm(loglongevity~thorax+activity, data = data_flies) # prepare model
anova(model_1); table <- summary(model_1)$coefficients; table
# extract model's parameter
intercept <- table[,1][1]; beta <- table[,1][2]
alpha_high <- 0; alpha_low <- table[,1][4]
alpha_isolated <- table[,1][3]
# calculate mean thorax
mean_thorax <- mean(data_flies$thorax)
# calculate estimates
estimate_high <- exp(1)**(intercept + alpha_high + beta * mean_thorax)
estimate_low <- exp(1)**(intercept + alpha_low + beta * mean_thorax)
estimate_isolated <- exp(1)**(intercept + alpha_isolated + beta * mean_thorax)
estimates <- c(estimate_isolated, estimate_low, estimate_high)
activity_levels <- unique(as.character(data_flies$activity))
knitr::kable(data.frame(Activity = activity_levels,
`Longevity estimate` = estimates),
caption = "Longevity estimates for average thorax fruit fly")
```{r, fig.width = 12, fig.height=6}
plot(data_flies$loglongevity~data_flies$thorax,pch=unclass(data_flies$activity))
for (i in activity_levels) {
abline(lm(loglongevity~thorax
,data=data_flies[data_flies$activity==i,]))}
plot(data_flies$loglongevity~data_flies$thorax,pch=unclass(data_flies$activity))
for (i in activity_levels) {
abline(lm(loglongevity~thorax
,data=data_flies[data_flies$activity==i,]))}
# perform ANCOVA with interaction analysis
model_interaction <- lm(loglongevity~thorax*activity, data = data_flies) # prepare model
par(mfrow=c(1,2)); plot(model_interaction , 1); plot(model_interaction , 2) # investigate normality
anova(model_interaction)
par(mfrow=c(1,2)); plot(model_1 , 1); plot(model_1 , 2) # investigate normality
# perform additive ANCOVA analysis
model <- lm(longevity~thorax+activity, data = data_flies) # prepare model
# extract model's parameter
intercept <- table[,1][1]; beta <- table[,1][2]
alpha_high <- 0; alpha_low <- table[,1][4]
alpha_isolated <- table[,1][3]
# calculate mean thorax
mean_thorax <- mean(data_flies$thorax)
# calculate estimates
estimate_high <- intercept + alpha_high + beta * mean_thorax
estimate_low <- intercept + alpha_low + beta * mean_thorax
estimate_isolated <- intercept + alpha_isolated + beta * mean_thorax
estimates <- c(estimate_isolated, estimate_low, estimate_high)
activity_levels <- unique(as.character(data_flies$activity))
knitr::kable(data.frame(Activity = activity_levels,
`Longevity estimate` = estimates),
caption = "Longevity estimates for average thorax fruit fly")
par(mfrow=c(1,3))
titanic <- read.table(file="data/titanic.txt", header=TRUE)
titanic$Survived = as.factor(titanic$Survived)
plot1 <- qplot(x = Age, fill = Survived, data = titanic, show.legend = FALSE)
plot2 <- qplot(x = PClass, fill = Survived, data = titanic, show.legend = FALSE)
plot3 <- qplot(x = Sex,fill=Survived, data = titanic)
grid.arrange(plot1, plot2, plot3, ncol=3)
grid.arrange(plot1, plot2, plot3, ncol=3)
titanic <- read.table(file="data/titanic.txt", header=TRUE)
class_sex =  xtabs(~PClass+ Sex, data=titanic);knitr::kable(class_sex)
class_sex =  xtabs(~PClass+ Sex, data=titanic);knitr::kable(class_sex)
tot = xtabs(Survived ~ PClass + Sex, data=titanic);knitr::kable(tot)
knitr::kable(round(tot/class_sex, 2))
# what to do with NAs?
titanic$PClass <- as.factor(titanic$PClass)
titanic$Sex <- as.factor(titanic$Sex)
logistic <- glm(Survived~PClass+Age+Sex, data = titanic, family = binomial)
summary(logistic)$coefficients
drop1(logistic,test="Chisq")
drop1(logistic,test="Chisq")
odds_male_example =  exp(3.7597 + 1 * -1.2920 + 0 * -2.5214 + 1 * -2.6314 + 25 * -0.0392)
odds_male_example =  exp(3.7597 + 1 * -1.2920 + 0 * -2.5214 + 1 * -2.6314 + 25 * -0.0392)
odds_male_example
odds_female_example =  exp(3.7597 + 0 * -1.2920 + 0 * -2.5214 + 0 * -2.6314 + 25 * -0.0392)
odds_female_example
# what to do with NAs?
titanic$PClass <- as.factor(titanic$PClass)
titanic$Sex <- as.factor(titanic$Sex)
logistic <- glm(Survived~PClass+Age+Sex, data = titanic, family = binomial)
summary(logistic)$coefficients
drop1(logistic,test="Chisq")
odds_male_example =  exp(3.7597 + 1 * -1.2920 + 0 * -2.5214 + 1 * -2.6314 + 25 * -0.0392)
odds_male_example
odds_female_example =  exp(3.7597 + 0 * -1.2920 + 0 * -2.5214 + 0 * -2.6314 + 25 * -0.0392)
odds_female_example
# interaction of sex and age
logistic_interaction_sex <- glm(Survived~Age*Sex, data = titanic, family = binomial)
summary(logistic_interaction_sex)$coefficients
# interaction of PClass and age
logistic_interaction_pclass <- glm(Survived~Age*PClass, data = titanic, family = binomial)
summary(logistic_interaction_pclass)$coefficients
# Makes a contingency table and chi-squared test for survived with class and gender
tab1 = table(titanic$Survived,titanic$Sex)
fisher.test(tab1)
total_s= rowSums(rbind(tab1,NaN));total_g = colSums(tab1);
tab1 = rbind(tab1,total_g);tab1 = cbind(tab1,total_s)
knitr::kable(tab1)
tab2 = table(titanic$Survived,titanic$PClass)
chisq.test(tab2)
total_c= rowSums(tab2);total_g = colSums(tab2);
