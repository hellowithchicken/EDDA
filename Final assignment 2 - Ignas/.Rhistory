library(tidyverse)
library(rstudioapi)
library(lme4)
library(car)
library(gridExtra)
knitr::opts_chunk$set(echo = TRUE)
setwd(dirname(getActiveDocumentContext()$path))
# round numbers to 3 digits
options(digits = 3)
# read the data
data <- read.table(file="data/diet.txt", header=TRUE)
library(tidyverse)
library(rstudioapi)
library(lme4)
library(car)
library(gridExtra)
knitr::opts_chunk$set(echo = TRUE)
setwd(dirname(getActiveDocumentContext()$path))
# round numbers to 3 digits
options(digits = 3)
library(tidyverse)
library(rstudioapi)
library(lme4)
library(car)
library(gridExtra)
knitr::opts_chunk$set(echo = TRUE)
setwd(dirname(getActiveDocumentContext()$path))
# round numbers to 3 digits
options(digits = 3)
# read the data
data <- read.table(file="data/diet.txt", header=TRUE)
data$diet <- as.factor(data$diet)
data$gender <- as.factor(data$gender)
# create new variable
data <- data %>% mutate(weight.lost = preweight - weight6weeks)
# remove missing data points
data <- data %>% filter(!is.na(gender))
# perform a paired t-test to see if the weight before and after are significantly different
t.test(data$preweight, data$weight6weeks, paired = TRUE)
# diagnostics
par(mfrow=c(1,2)); qqnorm(data$preweight); qqnorm(data$weight6weeks)
# diagnostics
par(mfrow=c(1,2)); qqnorm(data$preweight); qqnorm(data$weight6weeks)
shapiro.test(data$preweight)
shapiro.test(data$weight6weeks)
# read the data
data <- read.table(file="data/diet.txt", header=TRUE)
data$diet <- as.factor(data$diet)
data$gender <- as.factor(data$gender)
# create new variable
data <- data %>% mutate(weight.lost = preweight - weight6weeks)
# diagnostics
par(mfrow=c(1,2)); qqnorm(data$preweight); qqnorm(data$weight6weeks)
shapiro.test(data$preweight)
shapiro.test(data$weight6weeks)
# read the data
data <- read.table(file="data/diet.txt", header=TRUE)
data$diet <- as.factor(data$diet)
data$gender <- as.factor(data$gender)
# create new variable
data <- data %>% mutate(weight.lost = preweight - weight6weeks)
# remove missing data points
data <- data %>% filter(!is.na(gender))
# perform a paired t-test to see if the weight before and after are significantly different
t.test(data$preweight, data$weight6weeks, paired = TRUE)
# diagnostics
par(mfrow=c(1,2)); qqnorm(data$preweight); qqnorm(data$weight6weeks)
shapiro.test(data$preweight)
shapiro.test(data$weight6weeks)
library(tidyverse)
library(rstudioapi)
library(lme4)
library(car)
library(gridExtra)
knitr::opts_chunk$set(echo = TRUE)
setwd(dirname(getActiveDocumentContext()$path))
# round numbers to 3 digits
options(digits = 3)
# read the data
data <- read.table(file="data/diet.txt", header=TRUE)
data$diet <- as.factor(data$diet)
data$gender <- as.factor(data$gender)
# create new variable
data <- data %>% mutate(weight.lost = preweight - weight6weeks)
# remove missing data points
data <- data %>% filter(!is.na(gender))
# perform a paired t-test to see if the weight before and after are significantly different
t.test(data$preweight, data$weight6weeks, paired = TRUE)
# diagnostics
par(mfrow=c(1,2)); qqnorm(data$preweight); qqnorm(data$weight6weeks)
shapiro.test(data$preweight)
shapiro.test(data$weight6weeks)
# diagnostics
qqnorm(data$weight.lost)
shapiro.test(data$weight.lost)
# perform one-tailed t-test
round(t.test(data$weight.lost, mu=3, alternative = "greater", conf.level = 0.95)$p.value, 3)
# perform one-way ANOVA
model <- lm(weight.lost ~ diet, data = data)
anova(model)
summary(model)$coefficients
paste("r-squared:", round(summary(model)$r.squared, 4))
# diagnostics
par(mfrow=c(1,2));
plot(model, 1); plot(model, 2)
# perform two-way ANOVA with interaction
model <- lm(weight.lost ~ diet * gender, data = data)
anova(model)
# investigate visually
plot(data$weight.lost~data$height,pch=unclass(data$gender))
diets <- unique(as.character(data$diet))
for (i in diets) {
abline(lm(weight.lost~height
,data=data[data$diet==i,]))}
# perform ANCOVA with interaction
model <- lm(weight.lost ~ diet*height, data = data)
anova(model)
# perform additive ANCOVA
model <- lm(weight.lost ~ height + diet, data = data)
anova(model)
paste("r-squared:", round(summary(model)$r.squared, 4))
logistic <- glm(lost.4kg~diet, data = data, family = binomial)
# create new variable
data <- data %>% mutate(lost.4kg = as.factor(ifelse(weight.lost > 4, 1, 0)))
logistic <- glm(lost.4kg~diet, data = data, family = binomial)
drop1(logistic, test="Chisq")
logistic <- glm(lost.4kg~diet, data = data, family = binomial)
anova(logistic, test="Chisq")
logistic <- glm(lost.4kg~diet, data = data, family = binomial)
drop1(logistic, test="Chisq")
logistic <- glm(lost.4kg~diet*gender, data = data, family = binomial)
summary(logistic)$coefficients
logistic <- glm(lost.4kg~diet*gender, data = data, family = binomial)
summary(logistic)$coefficients
anova(logistic)
logistic <- glm(lost.4kg~diet*gender, data = data, family = binomial)
summary(logistic)$coefficients
anova(logistic, test = "Chisq")
