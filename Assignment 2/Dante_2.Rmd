---
title: "EDDA - Assignment 2 - Group 77"
subtitle: "Dante de Lang, Ignas Krikštaponis and Kamiel Gülpen"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
library(tidyverse)
library(rstudioapi)

knitr::opts_chunk$set(echo = TRUE)
setwd(dirname(getActiveDocumentContext()$path))
# round numbers to 3 digits
options(digits = 3)
```

# Exercise 1
Moldy bread If left alone bread will become moldy, rot or decay otherwise.  To investigate the influence of temperature and  humidity  on  this  process,  the  time  to  decay  was  measured  for  18  slices  of  white  bread,  which  were placed in 3 different environments and humidified or not.  The data are given in the filebread.txt, with the first column time to decay in hours, the second column the environment (cold, warm or intermediate temperature) and the third column the humidity.


**a)** The 18 slices came from a single loaf, but were randomized to the 6 combinations of conditions. Present an R-code for this randomization process.
```{r}
data_bread <- read.table(file="data/bread.txt",header=TRUE)
humid <- c("dry","wet")
temp <- c("cold", "intermediate","warm")

combination <- data.frame(cbind(c(humid,humid,humid),c(temp,temp)))

```

**b)** Make two boxplots of hours versus the two factors and two interaction plots (keeping the two factors fixed in turn).

```{r}
data_bread

attach(data_bread)
par(mfrow=c(1,2))
boxplot(hours~environment)
boxplot(hours~humidity)

par(mfrow=c(1,2))
interaction.plot(environment,humidity,hours)
interaction.plot(humidity,environment,hours)
```

**c)** Perform an analysis of variance to test for eect of the factors temperature, humidity, and their interaction. Describe the interaction effect in words.
```{r}
aovbread = lm(hours~environment+humidity)
anova(aovbread)
summary(aovbread)
```

**d)** Which of the two factors has the greatest (numerical) influence on the decay? Is this a good question?
```{r}

```


**e)** Check the model assumptions by using relevant diagnostic tools. Are there any outliers?
```{r}
par(mfrow=c(1,2))
qqnorm(residuals(aovbread))
plot(fitted(aovbread),residuals(aovbread))
```

# Exercise 2
A researcher is interested in the time it takes a student to find a certain product on the internet using a search engine. There are three different types of interfaces with the search engine and especially the effect of these interfaces is of importance. There are five different types of students, indicating their level of computer skill (the lower the value of this indicator, the better the computer skill of the corresponding student). Fifteen students are selected; three from each group with a certain level of computer skill. The data is given in the file search.txt. Assume that the experiment was run according to a randomized block design which you make in a). (Beware that the levels of the factors are coded by numbers.)

**a)** Number the selected students 1 to 15 and show how (by using R) the students could be randomized to the interfaces in a randomized block design.
```{r}
data_search <- read.table(file="data/search.txt",header=TRUE)

interface <- factor(rep(c("1","2","3"),each = 5))
skill <- factor(rep(c("1","2","3","4","5"),times = 3))
students <- c(1:15)
block <- data.frame(students,skill,interface)

block

```
**b)** Test the null hypothesis that the search time is the same for all interfaces. What type of interface does require the longest search time? For which combination of skill level and type of interface is the search time the shortest? Estimate the time it takes a typical user of skill level 3 to find the product on the website if the website uses interface 3.
```{r}
attach(data_search)

aovsearch = lm(time~interface+skill)
anova(aovsearch)

boxplot(time~interface) # Interface 3 has the longest search time

interaction.plot(skill,interface,time) # Skill 2 and interface 1 is the fastest

summary(aovsearch) # Estimate interface 3 = 4.46, skill 3 = 3.03, so 3-3 gives:

(4.46+3.03)/2 # 3.75 seconds ????

```
**c)** Check the model assumptions by using relevant diagnostic tools.
```{r}

```

